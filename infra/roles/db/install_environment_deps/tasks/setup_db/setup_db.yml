---
- name: Create a new database with name "acme"
  become: true
  become_user: root
  community.postgresql.postgresql_db:
    name: acme

# This example uses the 'priv' argument which is deprecated.
# You should use the 'postgresql_privs' module instead.
- name: Connect to acme database and set user's password with no expire date
  become: true
  become_user: root
  community.postgresql.postgresql_user:
    db: proj
    name: django
    password: mysupersecretword
    expires: infinity

# Note that here "db: postgres" specifies the database to connect to, not the
# database to grant privileges on (which is specified via the "objs" param)
- name: GRANT ALL PRIVILEGES ON DATABASE library TO librarian
  community.postgresql.postgresql_privs:
    db: proj
    privs: ALL
    type: database
    obj: table
    role: django
